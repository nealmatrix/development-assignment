# C++ Development Assignment

Research on the [Google FlatBuffers projects](https://google.github.io/flatbuffers/) and work on following tasks:

- Write a sample schema that can represent a property tree (property name, property value, property type, and sub-properties).
- Write code snippets in C++ that can read/update on the property object generated by the FlatBuffers compiler.
- Write code snippets in C++ that can send/receive the property object over TCP socket.
- Write code snippets in C++ that use the reflection API to read from the TCP socket and iterate over the elements stored inside the property tree.
- Consider the property tree will be updated frequently by the sender, think of a solution that synchronize the updates to the receiver.

---

### Task 1

- build flatc compiler tool
```bash
git clone https://github.com/google/flatbuffers.git
cd flatbuffers
mkdir build
cd build
cmake -G "Unix Makefiles" -DCMAKE_BUILD_TYPE=Release ..
make
```
- sample schema
    - property.fbs
    - defines property object
- compile the property schema
```bash
../open_sources/flatbuffers/build/flatc --gen-mutable --cpp property.fbs
```

---

### Task 2
- read property object
    - `void read_property(uint8_t *buffer_pointer)` 
    - header in functions.h
    - source code in functions.cc
- update property object
    - `void update_property(uint8_t *buffer_pointer, float new_value)` 
    - header in functions.h
    - source code in functions.cc
- main program
    - read_update.cc
- compile and run
```bash
clang++ -Wall -std=c++11 -I"/Users/chuanyu/Dropbox/Code/Projects/open_sources/flatbuffers/include/" -c read_update.cc functions.cc
clang++ functions.o read_update.o -o read_update.out
./read_update.out
```
- output
```bash
buffer size: 68
property_name: my_proptery
property_value: 1.23
property_type: my_type
after change:
property_name: my_proptery
property_value: 10
property_type: my_type
```

---

### Task 3
- send property over TCP socket
    - `void start_client()` 
    - header in functions.h
    - source code in functions.cc
- receive property over TCP socket
    - `void stop_server(int p)`, `void start_server()` 
    - header in functions.h
    - source code in functions.cc
- main program
    - client.cc
    - server.cc
- compile and run
```bash
clang++ -Wall -std=c++11 -I"/Users/chuanyu/Dropbox/Code/Projects/open_sources/flatbuffers/include/" -c server.cc client.cc functions.cc
clang++ functions.o client.o -o client.out
clang++ functions.o server.o -o server.out
./server.out
./client.out
```
- server output
```bash
property_name: my_proptery
property_value: 1.23
property_type: my_type
^Cclose server
```
- client output
```bash
buffer size: 68
```

---

### Task 4

---

### Task 5
- One of the solutions is to use publish-subscribe messaging. In a pub/sub model, any message published to a topic by sender is immediately received by the subscribers to the topic. 
- In crypto exchange, it is usually to use websocket which utilizes publish-subscribe pattern. Websocket provides full-duplex communication channels over a single TCP connection. Users can get public and private data from exchanges passively.